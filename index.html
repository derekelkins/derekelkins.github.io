<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="A blog mostly on math, physics, and computer science.">
    <meta name="author" content="Derek Elkins">
    <!--<link rel="icon" href="/images/favicon.ico">-->

    <title>Home</title>
    <!-- Bootstrap core CSS -->
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="./css/blog.css" rel="stylesheet">
    <link href="./css/syntax.css" rel="stylesheet">
  </head>

  <body>
    <div class="blog-masthead">
      <div class="container">
        <nav class="blog-nav">
          <a class="blog-nav-item active" href="./">Home</a>
          <a class="blog-nav-item " href="./about.html">About</a>
          <a class="blog-nav-item " href="./contact.html">Contact</a>
          <a class="blog-nav-item " href="./readinglist.html">Reading List</a>
          <a class="blog-nav-item " href="./archive.html">Archive</a>
          <a class="blog-nav-item pull-right" href="./rss.xml">RSS</a>
          <a class="blog-nav-item pull-right" href="./atom.xml">Atom</a>
        </nav>
      </div>
    </div>

    <div class="container">
      
          <div class="blog-header">
            <a href="./"><h1 class="blog-title">Hedonistic Learning</h1></a>
            <p class="lead blog-description">Learning for the fun of it</p>
          </div>
      
      <div class="row">
        
        <div class="col-sm-8 blog-main">
        
          
    <div class="blog-post teaser panel panel-default">
    <div class="panel-heading">
        <h2 class="blog-post-title"><a href="./posts/constructivist-motto.html">Constructivist Motto</a></h2>
        <h6 class="pull-right" style="margin-top: -1.5ex"><a data-disqus-identifier="c284bd21-75e4-4c66-a499-49f3719f7a09" href="./posts/constructivist-motto.html#disqus_thread"></a></h6>
    </div>

    <div class="panel-body">
        
            <blockquote>
<p>I don’t believe classical logic is false; I just believe that it is not true.</p>
</blockquote>
        
    </div>

    <div class="panel-footer">
        <h6 class="blog-post-meta">
            May  7, 2016 18:12 UTC
            
            (Last updated on May  7, 2016 18:17 UTC)

            
                Tags: <a href="./tags/math.html">math</a>
            
        </h6>
    </div>

</div><!-- /.blog-post -->



    <div class="blog-post teaser panel panel-default">
    <div class="panel-heading">
        <h2 class="blog-post-title"><a href="./posts/the-mistake-everyone-makes-with-knockoutjs.html">The Mistake Everyone Makes with KnockoutJS</a></h2>
        <h6 class="pull-right" style="margin-top: -1.5ex"><a data-disqus-identifier="d07dccbe-b66a-437f-b8fc-0c4442d340b6" href="./posts/the-mistake-everyone-makes-with-knockoutjs.html#disqus_thread"></a></h6>
    </div>

    <div class="panel-body">
        
            <h3 id="introduction">Introduction</h3>
<p><a href="http://knockoutjs.com">Knockout</a> is a nice JavaScript library for making values that automatically update when any of their “dependencies” update. Those dependencies can form an arbitrary directed acyclic graph. Many people seem to think of it as “yet another” templating library, but the core idea which is useful far beyond “templating” is the notion of observable values. One nice aspect is that it is a library and not a framework so you can use it as little or as much as you want and you can integrate it with other libraries and frameworks.</p>
<p>At any rate, this article is more geared toward those who have already decided on using Knockout or a library (in any language) offering similar capabilities. I strongly suspect the issues and solutions I’ll discuss apply to all similar sorts of libraries. While I’ll focus on one particular example, the ideas behind it apply generally. This example, admittedly, is one that almost anyone will implement, and in my experience will do it incorrectly the first time and won’t realize the problem until later.</p>
<h3 id="the-problem">The Problem</h3>
<p>When doing any front-end work, before long there will be a requirement to support “multi-select” of something. Of course, you want the standard select/deselect all functionality and for it to work correctly, and of course you want to do something with the items you’ve selected. Here’s a very simple example:</p>
<div id="#badExample">
Number selected: <span data-bind="text: $data.numberSelected()"></span>
<table>
<tr>
<th>
<input type="checkbox" data-bind="checked: $data.allSelected" />
</th>
<th>
Item
</th>
</tr>
<!-- ko foreach: { data: $data.items(), as: '$item' } -->
<tr>
<td>
<input type="checkbox" data-bind="checked: $data.selected" />
</td>
<td data-bind="text: 'Item number: '+$data.body">
</td>
</tr>
<!-- /ko -->
<tr>
<td>
<button data-bind="click: function() { $data.add(); }">
Add
</button>
</td>
</tr>
</table>
</div>
<p>Here, the number selected is an overly simple example of using the selected items. More realistically, the selected items will trigger other items to show up and/or trigger AJAX requests to update the data or populate other data. The HTML for this example is completely straightforward.</p>
<div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;#badExample&quot;</span><span class="kw">&gt;</span>
    Number selected: <span class="kw">&lt;span</span><span class="ot"> data-bind=</span><span class="st">&quot;text: $data.numberSelected()&quot;</span><span class="kw">&gt;&lt;/span&gt;</span>
    <span class="kw">&lt;table&gt;</span>
        <span class="kw">&lt;tr&gt;&lt;th&gt;&lt;input</span><span class="ot"> type=</span><span class="st">&quot;checkbox&quot;</span><span class="ot"> data-bind=</span><span class="st">&quot;checked: $data.allSelected&quot;</span><span class="kw">/&gt;&lt;/th&gt;&lt;th&gt;</span>Item<span class="kw">&lt;/th&gt;&lt;/tr&gt;</span>
        <span class="co">&lt;!-- ko foreach: { data: $data.items(), as: '$item' } --&gt;</span>
        <span class="kw">&lt;tr&gt;&lt;td&gt;&lt;input</span><span class="ot"> type=</span><span class="st">&quot;checkbox&quot;</span><span class="ot"> data-bind=</span><span class="st">&quot;checked: $data.selected&quot;</span><span class="kw">/&gt;&lt;/td&gt;&lt;td</span><span class="ot"> data-bind=</span><span class="st">&quot;text: 'Item number: '+$data.body&quot;</span><span class="kw">&gt;&lt;/td&gt;&lt;/tr&gt;</span>
        <span class="co">&lt;!-- /ko --&gt;</span>
        <span class="kw">&lt;tr&gt;&lt;td&gt;&lt;button</span><span class="ot"> data-bind=</span><span class="st">&quot;click: function() { $data.add(); }&quot;</span><span class="kw">&gt;</span>Add<span class="kw">&lt;/button&gt;&lt;/td&gt;&lt;/tr&gt;</span>
    <span class="kw">&lt;/table&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre></div>
<p>The way nearly everyone (including me) first thinks to implement this is by adding a <code>selected</code> observable to each item and then having <code>allSelected</code> depend on all of the <code>selected</code> observables. Since we also want to write to <code>allSelected</code> to change the state of the <code>selected</code> observables we use a <a href="http://knockoutjs.com/documentation/computed-writable.html">writable computed observable</a>. This computed observable will loop through all the items and check to see if they are all set to determine it’s state. When it is updated, it will loop through all the <code>selected</code> observables and set them to the appropriate state. Here’s the full code listing.</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> badViewModel <span class="op">=</span> <span class="op">{</span>
    <span class="dt">counter</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span>
    <span class="dt">items</span><span class="op">:</span> <span class="va">ko</span>.<span class="at">observableArray</span>()
<span class="op">};</span>

<span class="va">badViewModel</span>.<span class="at">allSelected</span> <span class="op">=</span> <span class="va">ko</span>.<span class="at">computed</span>(<span class="op">{</span>
    <span class="dt">read</span><span class="op">:</span> <span class="kw">function</span>() <span class="op">{</span>
        <span class="kw">var</span> items <span class="op">=</span> <span class="va">badViewModel</span>.<span class="at">items</span>()<span class="op">;</span>
        <span class="kw">var</span> allSelected <span class="op">=</span> <span class="kw">true</span><span class="op">;</span>
        <span class="cf">for</span>(<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="va">items</span>.<span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span> <span class="co">// Need to make sure we depend on each item, so don't break out of loop early</span>
            allSelected <span class="op">=</span> allSelected <span class="op">&amp;&amp;</span> items[i].<span class="at">selected</span>()<span class="op">;</span>
        <span class="op">}</span>
        <span class="cf">return</span> allSelected<span class="op">;</span>
    <span class="op">},</span>
    <span class="dt">write</span><span class="op">:</span> <span class="kw">function</span>(newValue) <span class="op">{</span>
        <span class="kw">var</span> items <span class="op">=</span> <span class="va">badViewModel</span>.<span class="at">items</span>()<span class="op">;</span>
        <span class="cf">for</span>(<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="va">items</span>.<span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span>
            items[i].<span class="at">selected</span>(newValue)<span class="op">;</span>
        <span class="op">}</span>
    <span class="op">}</span>
<span class="op">}</span>)<span class="op">;</span>

<span class="va">badViewModel</span>.<span class="at">numberSelected</span> <span class="op">=</span> <span class="va">ko</span>.<span class="at">computed</span>(<span class="kw">function</span>() <span class="op">{</span>
    <span class="kw">var</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>
    <span class="kw">var</span> items <span class="op">=</span> <span class="va">badViewModel</span>.<span class="at">items</span>()<span class="op">;</span>
    <span class="cf">for</span>(<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="va">items</span>.<span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span>
        <span class="cf">if</span>(items[i].<span class="at">selected</span>()) count<span class="op">++;</span>
    <span class="op">}</span>
    <span class="cf">return</span> count<span class="op">;</span>
<span class="op">}</span>)<span class="op">;</span>

<span class="va">badViewModel</span>.<span class="at">add</span> <span class="op">=</span> <span class="kw">function</span>() <span class="op">{</span>
    <span class="va">badViewModel</span>.<span class="va">items</span>.<span class="at">push</span>(<span class="op">{</span>
        <span class="dt">body</span><span class="op">:</span> <span class="va">badViewModel</span>.<span class="at">counter</span><span class="op">++,</span>
        <span class="dt">selected</span><span class="op">:</span> <span class="va">ko</span>.<span class="at">observable</span>(<span class="kw">false</span>)
    <span class="op">}</span>)<span class="op">;</span>
<span class="op">};</span>

<span class="va">ko</span>.<span class="at">applyBindings</span>(badViewModel<span class="op">,</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">'#badExample'</span>))<span class="op">;</span></code></pre></div>
<p>This should be relatively straightforward, and it works, so what’s the problem? The problem can be seen in <code>numberSelected</code> (and it also comes up with <code>allSelected</code> which I’ll get to momentarily). <code>numberSelected</code> depends on <em>each</em> <code>selected</code> observable and so it will be fired <em>each</em> time <em>each</em> one updates. That means if you have 100 items, and you use the select all checkbox, <code>numberSelected</code> will be called 100 times. For this example, that doesn’t really matter. For a more realistic example than <code>numberSelected</code>, this may mean rendering one, then two, then three, … then 100 HTML fragments or making 100 AJAX requests. In fact, this same behavior is present in <code>allSelected</code>. When it is written, as it’s writing to the <code>selected</code> observables, it is also triggering <em>itself</em>.</p>
<p>So the problem is updating <code>allSelected</code> or <code>numberSelected</code> can’t be done all at once, or to use database terminology, it can’t be updated atomically. One possible solution in newer versions of Knockout is to use <code>deferredUpdates</code> or, what I did back in the much earlier versions of Knockout, abuse the rate limiting features. The problem with this solution is that it makes updates asynchronous. If you’ve written your code to not care whether it was called synchronously or asynchronously, then this will work fine. If you haven’t, doing this throws you into a world of shared state concurrency and race conditions. In this case, this solution is far worse than the disease.</p>
<h3 id="the-solution">The Solution</h3>
<p>So, what’s the alternative? We want to update all selected items atomically; we can atomically update a single observable; so we’ll put all selected items into a single observable. Now an item determines if it is selected by checking whether it is in the collection of selected items. More abstractly, we make our observables more coarse-grained, and we have a bunch of small computed observables depend on a large observable instead of a large computed observable depending on a bunch of small observables as we had in the previous code. Here’s an example using the exact same HTML and presenting the same overt behavior.</p>
<div id="#goodExample">
Number selected: <span data-bind="text: $data.numberSelected()"></span>
<table>
<tr>
<th>
<input type="checkbox" data-bind="checked: $data.allSelected" />
</th>
<th>
Item
</th>
</tr>
<!-- ko foreach: { data: $data.items(), as: '$item' } -->
<tr>
<td>
<input type="checkbox" data-bind="checked: $data.selected" />
</td>
<td data-bind="text: 'Item number: '+$data.body">
</td>
</tr>
<!-- /ko -->
<tr>
<td>
<button data-bind="click: function() { $data.add(); }">
Add
</button>
</td>
</tr>
</table>
</div>
<p>And here’s the code behind this second example:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> goodViewModel <span class="op">=</span> <span class="op">{</span>
    <span class="dt">counter</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span>
    <span class="dt">selectedItems</span><span class="op">:</span> <span class="va">ko</span>.<span class="at">observableArray</span>()<span class="op">,</span>
    <span class="dt">items</span><span class="op">:</span> <span class="va">ko</span>.<span class="at">observableArray</span>()
<span class="op">};</span>

<span class="va">goodViewModel</span>.<span class="at">allSelected</span> <span class="op">=</span> <span class="va">ko</span>.<span class="at">computed</span>(<span class="op">{</span>
    <span class="dt">read</span><span class="op">:</span> <span class="kw">function</span>() <span class="op">{</span>
        <span class="cf">return</span> <span class="va">goodViewModel</span>.<span class="at">items</span>().<span class="at">length</span> <span class="op">===</span> <span class="va">goodViewModel</span>.<span class="at">selectedItems</span>().<span class="at">length</span><span class="op">;</span>
    <span class="op">},</span>
    <span class="dt">write</span><span class="op">:</span> <span class="kw">function</span>(newValue) <span class="op">{</span>
        <span class="cf">if</span>(newValue) <span class="op">{</span>
            <span class="va">goodViewModel</span>.<span class="at">selectedItems</span>(<span class="va">goodViewModel</span>.<span class="at">items</span>().<span class="at">slice</span>(<span class="dv">0</span>))<span class="op">;</span> <span class="co">// Need a copy!</span>
        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span>
            <span class="va">goodViewModel</span>.<span class="va">selectedItems</span>.<span class="at">removeAll</span>()<span class="op">;</span>
        <span class="op">}</span>
    <span class="op">}</span>
<span class="op">}</span>)<span class="op">;</span>

<span class="va">goodViewModel</span>.<span class="at">numberSelected</span> <span class="op">=</span> <span class="va">ko</span>.<span class="at">computed</span>(<span class="kw">function</span>() <span class="op">{</span>
    <span class="cf">return</span> <span class="va">goodViewModel</span>.<span class="at">selectedItems</span>().<span class="at">length</span><span class="op">;</span>
<span class="op">}</span>)<span class="op">;</span>

<span class="va">goodViewModel</span>.<span class="at">add</span> <span class="op">=</span> <span class="kw">function</span>() <span class="op">{</span>
    <span class="kw">var</span> item <span class="op">=</span> <span class="op">{</span> <span class="dt">body</span><span class="op">:</span> <span class="va">goodViewModel</span>.<span class="at">counter</span><span class="op">++</span> <span class="op">}</span>
    <span class="va">item</span>.<span class="at">selected</span> <span class="op">=</span> <span class="va">ko</span>.<span class="at">computed</span>(<span class="op">{</span>
        <span class="dt">read</span><span class="op">:</span> <span class="kw">function</span>() <span class="op">{</span>
            <span class="cf">return</span> <span class="va">goodViewModel</span>.<span class="va">selectedItems</span>.<span class="at">indexOf</span>(item) <span class="op">&gt;</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span>
        <span class="op">},</span>
        <span class="dt">write</span><span class="op">:</span> <span class="kw">function</span>(newValue) <span class="op">{</span>
            <span class="cf">if</span>(newValue) <span class="op">{</span>
                <span class="va">goodViewModel</span>.<span class="va">selectedItems</span>.<span class="at">push</span>(item)<span class="op">;</span>
            <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span>
                <span class="va">goodViewModel</span>.<span class="va">selectedItems</span>.<span class="at">remove</span>(item)<span class="op">;</span>
            <span class="op">}</span>
        <span class="op">}</span>
    <span class="op">}</span>)<span class="op">;</span>
    <span class="va">goodViewModel</span>.<span class="va">items</span>.<span class="at">push</span>(item)<span class="op">;</span>
<span class="op">};</span>

<span class="va">ko</span>.<span class="at">applyBindings</span>(goodViewModel<span class="op">,</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">'#goodExample'</span>))<span class="op">;</span></code></pre></div>
<p>One thing to note is that setting <code>allSelected</code> and <code>numberSelected</code> are now both simple operations. A write to an observable on triggers a constant number of writes to other observables. In fact, there are only two (non-computed) observables. On the other hand, <em>reading</em> the <code>selected</code> observable is more expensive. Toggling all items has quadratic complexity. In fact, it had quadratic complexity before due to the feedback. However, unlike the previous code, this <em>also</em> has quadratic complexity when any <em>individual</em> item is toggled. Unlike the previous code, though, this is simply due to a poor choice of data structure. Equipping each item with an “ID” field and using an object as a hash map would reduce the complexity to linear. In practice, for this sort of scenario, it tends not to make a big difference. Also, Knockout won’t trigger dependents if the value doesn’t change, so there’s no risk of the extra work propagating into still more extra work. Nevertheless, while I endorse this solution for this particular problem, in general making <em>finer</em> grained observables can help limit the scope of changes so unnecessary work isn’t done.</p>
<p>Still, the real concern and benefit of this latter approach isn’t the asymptotic complexity of the operations, but the <em>atomicity</em> of the operations. In the second solution, every update is atomic. There are no intermediate states on the way to a final state. This means that dependents, represented by <code>numberSelected</code> but which are realistically much more complicated, don’t get triggered excessively and don’t need to “compensate” for unintended intermediate values.</p>
<h3 id="epilogue">Epilogue</h3>
<p>We could take the coarse-graining to its logical conclusion and have the view model for an application be a single observable holding an object representing the entire view model (and containing no observables of its own). Taking this approach actually does have a lot of benefits, albeit there is little reason to use Knockout at that point. Instead this starts to lead to things like Facebook’s <a href="https://facebook.github.io/flux/">Flux</a> pattern and the pattern perhaps most clearly articulated by <a href="http://cycle.js.org/">Cycle JS</a>.</p>
<script lang="text/javascript" src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-3.3.0.js"></script>
<script lang="text/javascript">
// Bad View Model

var badViewModel = {
    counter: 0,
    items: ko.observableArray()
};

badViewModel.allSelected = ko.computed({
    read: function() {
        var items = badViewModel.items();
        var allSelected = true;
        for(var i = 0; i < items.length; i++) { // Need to make sure we depend on each item, so don't break out of loop early
            allSelected = allSelected && items[i].selected();
        }
        return allSelected;
    },
    write: function(newValue) {
        var items = badViewModel.items();
        for(var i = 0; i < items.length; i++) {
            items[i].selected(newValue);
        }
    }
});

badViewModel.numberSelected = ko.computed(function() {
    var count = 0;
    var items = badViewModel.items();
    for(var i = 0; i < items.length; i++) {
        if(items[i].selected()) count++;
    }
    return count;
});

badViewModel.add = function() {
    badViewModel.items.push({
        body: badViewModel.counter++,
        selected: ko.observable(false)
    });
};


// Good View Model

var goodViewModel = {
    counter: 0,
    selectedItems: ko.observableArray(),
    items: ko.observableArray()
};

goodViewModel.allSelected = ko.computed({
    read: function() {
        return goodViewModel.items().length === goodViewModel.selectedItems().length;
    },
    write: function(newValue) {
        if(newValue) {
            goodViewModel.selectedItems(goodViewModel.items().slice(0)); // Need a copy!
        } else {
            goodViewModel.selectedItems.removeAll();
        }
    }
});

goodViewModel.numberSelected = ko.computed(function() {
    return goodViewModel.selectedItems().length;
});

goodViewModel.add = function() {
    var item = { body: goodViewModel.counter++ }
    item.selected = ko.computed({
        read: function() {
            return goodViewModel.selectedItems.indexOf(item) > -1;
        },
        write: function(newValue) {
            if(newValue) {
                goodViewModel.selectedItems.push(item);
            } else {
                goodViewModel.selectedItems.remove(item);
            }
        }
    });
    goodViewModel.items.push(item);
};

ko.applyBindings(badViewModel, document.getElementById('#badExample'));
ko.applyBindings(goodViewModel, document.getElementById('#goodExample'));
</script>
        
    </div>

    <div class="panel-footer">
        <h6 class="blog-post-meta">
            May  5, 2016 20:38 UTC
            
            (Last updated on May  5, 2016 20:51 UTC)

            
                Tags: <a href="./tags/javascript.html">javascript</a>
            
        </h6>
    </div>

</div><!-- /.blog-post -->



    <div class="blog-post teaser panel panel-default">
    <div class="panel-heading">
        <h2 class="blog-post-title"><a href="./posts/understanding-typing-judgments.html">Understanding typing judgments</a></h2>
        <h6 class="pull-right" style="margin-top: -1.5ex"><a data-disqus-identifier="EE49D35E-A547-46A0-86F3-9419AFCEA309" href="./posts/understanding-typing-judgments.html#disqus_thread"></a></h6>
    </div>

    <div class="panel-body">
        
            <h3 id="introduction">Introduction</h3>
<p>For many people interested in type systems and type theory, their first encounter with the literature presents them with this:</p>
<p><code class="asciimath">#frac(Gamma,x:tau_1 |--_Sigma e : tau_2)(Gamma |--_Sigma (lambda x:tau_1.e) : tau_1 -&gt; tau_2) -&gt;I#</code></p>
<p><code class="asciimath">#frac(Gamma |--_Sigma f : tau_1 -&gt; tau_2 \qquad Gamma |--_Sigma x : tau_1)(Gamma |--_Sigma f x : tau_2) -&gt;E#</code></p>
<p>Since this notation is ubiquitous, authors (reasonably) expect readers to already be familiar with it and thus provide no explanation. Because the notation is ubiquitous, the beginner looking for alternate resources will not escape it. All they will find is that the notation is everywhere but exists in myriad minor variations which may or may not indicate significant differences. At this point the options are: 1) to muddle on and hope understanding the notation isn’t too important, 2) look for introductory resources which typically take the form of $50+ 500+ page textbooks, or 3) give up.</p>
<p>The goal of this article is to explain the notation part-by-part in common realizations, and to cover the main idea behind the notation which is the idea of an inductively defined relation. To eliminate ambiguity and make hand-waving impossible, I’ll ground the explanations in code, in particular, in <a href="http://wiki.portal.chalmers.se/agda/pmwiki.php">Agda</a>. That means for each example of the informal notation, there will be how it would be realized in Agda.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> It will become clear that I’m am not (just) using Agda as a formal notation to talk about these concepts, but that Agda’s<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> data type mechanism directly captures them<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>. The significance of this is that programmers are already familiar with many of the ideas behind the informal notation, and the notation is just obscuring this familiarity. Admittedly, Agda is itself pretty intimidating. I hope most of this article is accessible to those with familiarity with algebraic data types as they appear in Haskell, ML, Rust, or Swift with little to no need to look up details about Agda. Nevertheless, Agda at least has the benefit, when compared to the informal notation, of having a clear place to go to learn more, an unambiguous meaning, and tools that allow playing around with the ideas.</p>

            <h6><a href="./posts/understanding-typing-judgments.html">Read more...</a></h6>
        
    </div>

    <div class="panel-footer">
        <h6 class="blog-post-meta">
            April 13, 2016 02:41 UTC
            
            (Last updated on May  7, 2016 18:26 UTC)

            
                Tags: <a href="./tags/Agda.html">Agda</a>, <a href="./tags/type%20theory.html">type theory</a>
            
        </h6>
    </div>

</div><!-- /.blog-post -->



    <div class="blog-post teaser panel panel-default">
    <div class="panel-heading">
        <h2 class="blog-post-title"><a href="./posts/high-dimensional-thought-experiment.html">High dimensional thought experiment from Hamming</a></h2>
        <h6 class="pull-right" style="margin-top: -1.5ex"><a data-disqus-identifier="8CBD9E89-9943-45CA-9E5A-9CF2C04E5393" href="./posts/high-dimensional-thought-experiment.html#disqus_thread"></a></h6>
    </div>

    <div class="panel-body">
        
            <p>This is a simple mathematical thought experiment from Richard Hamming to demonstrate how poor our intuition  for high dimensional spaces is. All that is needed is some basic, middle school level geometry and algebra.  Consider a 2x2 square centered at the origin. In each quadrant place circles as big as possible so that they fit in the square and don’t overlap. They’ll clearly have radius 1/2. See the image below. The question now is what’s the radius of the largest circle centered at the origin that doesn’t overlap the other circles.  <img src="raw/high-dimensional-diagram.svg" alt />  It’s clear from symmetry that the inner circle is going to touch all the other circles at the same time, and it is clear that it is going to touch along the line from the origin to the center of one of the outer circles. So the radius of the inner circle, #r#, is just the distance from the origin to the center of one of the outer circles minus the radius of the outer circle, namely 1/2. As an equation:  <code class="asciimath">#r = sqrt(1/2^2 + 1/2^2) - 1/2 = sqrt(2)/2 - 1/2 ~~ 0.207106781#</code>  Now if we go to three dimensions we’ll have eight circles instead of four, but everything else is the same except the distances will now be <code class="asciimath">#sqrt(1/2^2 + 1/2^2 + 1/2^2)#</code>. It’s clear that the only  difference for varying dimensions is that in dimension #n# we’ll have #n# #1/2^2# terms under the square root sign. So the general solution is easily shown to be:  <code class="asciimath">#r = sqrt(n)/2 - 1/2#</code>  You should be weirded out now. If you aren’t, here’s a hint: what happens when #n = 10#? Here’s another hint: what happens as #n# approaches #oo#?</p>
        
    </div>

    <div class="panel-footer">
        <h6 class="blog-post-meta">
            December  4, 2015 01:22 UTC
            
            (Last updated on May  7, 2016 18:26 UTC)

            
                Tags: <a href="./tags/math.html">math</a>
            
        </h6>
    </div>

</div><!-- /.blog-post -->



    <div class="blog-post teaser panel panel-default">
    <div class="panel-heading">
        <h2 class="blog-post-title"><a href="./posts/behavioral-reflection.html">Behavioral Reflection</a></h2>
        <h6 class="pull-right" style="margin-top: -1.5ex"><a data-disqus-identifier="F0CE0069-CB69-4FE0-9B3B-9B161A3EF6E6" href="./posts/behavioral-reflection.html#disqus_thread"></a></h6>
    </div>

    <div class="panel-body">
        
            <h2 id="behavioral-reflection">Behavioral Reflection</h2>
<p>The ultimate goal of behavioral reflection (aka procedural reflection and no doubt other things) is to make a language where programs within the language are able to completely redefine the language as it executes. This is arguably the pinnacle of expressive power. This also means, though, local reasoning about code is utterly impossible, essentially by design.</p>
<p>Smalltalk is probably the language closest to this that is widely used. The Common Lisp MOP (Meta-Object Protocol) is also inspired by research in this vein. The ability to mutate classes and handle calls to missing methods as present in, e.g. Ruby, are also examples of very limited forms of behavioral reflection. (Though, for the latter, often the term “structural reflection” is used instead, reserving “behavioral reflection” for things beyond mere structural reflection.)</p>
<h3 id="very-brief-history">Very Brief History</h3>
<p>The seminal reference for behavioral reflection is Brian Smith’s 1982 <a href="http://publications.csail.mit.edu/lcs/specpub.php?id=840">thesis</a> on 3-LISP. This was followed by the languages <a href="http://cs.au.dk/~hosc/vol01/01-wand-friedman.html">Brown</a>, <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.40.2018&amp;rep=rep1&amp;type=pdf">Blond</a>, <a href="ftp://html.soic.indiana.edu/pub/techreports/TR362.pdf">Refci</a>, and <a href="http://www.is.ocha.ac.jp/~asai/Black/">Black</a> in chronological order. This is not a comprehensive list, and the last time I was in to this was about a decade ago. (Sure enough, there is some new work on Black and some very new citations of Black.)</p>
<!--[Reflection for the Masses](http://www.p-cos.net/documents/s32008.pdf) by Herzeel, Constanza, and D'Hondt.-->
<h3 id="core-idea">Core Idea</h3>
<p>The core idea is simply to expose the state of the (potentially conceptual) interpreter and allow it to be manipulated.</p>

            <h6><a href="./posts/behavioral-reflection.html">Read more...</a></h6>
        
    </div>

    <div class="panel-footer">
        <h6 class="blog-post-meta">
            November 17, 2015 00:54 UTC
            
            (Last updated on May  7, 2016 18:25 UTC)

            
                Tags: <a href="./tags/CS.html">CS</a>
            
        </h6>
    </div>

</div><!-- /.blog-post -->



    <div class="blog-post teaser panel panel-default">
    <div class="panel-heading">
        <h2 class="blog-post-title"><a href="./posts/you-know-more-about-presheaves-than-you-think.html">You know more about presheaves than you think</a></h2>
        <h6 class="pull-right" style="margin-top: -1.5ex"><a data-disqus-identifier="32F754A2-5428-4404-A21A-759092CC4010" href="./posts/you-know-more-about-presheaves-than-you-think.html#disqus_thread"></a></h6>
    </div>

    <div class="panel-body">
        
            <h3 id="the-category-of-graphs-as-a-presheaf">The category of graphs as a presheaf</h3>
<p>Here’s a small example of why people find category theory interesting. Consider the category, call it |ccC|, consisting of two objects, which we’ll imaginatively name |0| and |1|, and two non-identity arrows |s,t : 0 -&gt; 1|. The category of graphs (specifically directed multigraphs with loops) is the category of presheaves over |ccC|, which is to say, it’s the category of contravariant functors from |ccC| to <code class="asciimath">|cc&quot;Set&quot;|</code>. I’ll spell out what that means momentarily, but first think about what has been done. We’ve provided a complete definition of not only graphs but the entire category of graphs and graph homomorphisms given you’re familiar with very basic category theory<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. This is somewhat magical.</p>
<p>Spelling things out, |G| is a contravariant functor from |ccC| to <code class="asciimath">|cc&quot;Set&quot;|</code>. This means that |G| takes each object of |ccC| to a set, i.e. |G(0) = V| and |G(1) = E| for arbitrary sets |V| and |E|, but which will represent the vertices and edges of our graph. In addition, |G| takes the arrows in |ccC| to a (set) function, but, because it’s contravariant, it flips the arrows around. So we have, for example, |G(s) : G(1) -&gt; G(0)| or |G(s) : E -&gt; V|, and similarly for |t|. |G(s)| is a function that takes an edge and gives its source vertex, and |G(t)| gives the target. The arrows in the category of graphs are just natural transformations between the functors. In this case, that means if we have two graphs |G| and |H|, a graph homomorphism |f : G -&gt; H| is a pair of functions |f_0 : G(0) -&gt; H(0)| and |f_1 : G(1) -&gt; H(1)| that satisfy |H(s) @ f_1 = f_0 @ G(s)| and |H(t) @ f_1 = f_0 @ G(t)|. With a bit of thought you can see that all this says is that we must map the source and target of an edge |e| to the source and target of the edge |f_1(e)|. You may also have noticed that <em>any</em> pair of sets and pair of functions between them is a graph. In other words, graphs are very simple things. This takes out a lot of the magic, though it is nice that we get the right notion of graph homomorphism for free. Let me turn the magic up to 11.</p>

            <h6><a href="./posts/you-know-more-about-presheaves-than-you-think.html">Read more...</a></h6>
        
    </div>

    <div class="panel-footer">
        <h6 class="blog-post-meta">
            November  2, 2015 12:04 UTC
            
            (Last updated on November  2, 2015 13:56 UTC)

            
                Tags: <a href="./tags/CS.html">CS</a>, <a href="./tags/category%20theory.html">category theory</a>
            
        </h6>
    </div>

</div><!-- /.blog-post -->



    <div class="blog-post teaser panel panel-default">
    <div class="panel-heading">
        <h2 class="blog-post-title"><a href="./posts/styles-of-category-theory.html">The three styles of category theory</a></h2>
        <h6 class="pull-right" style="margin-top: -1.5ex"><a data-disqus-identifier="50477F76-898F-444F-AAD6-A4BC20802E5E" href="./posts/styles-of-category-theory.html#disqus_thread"></a></h6>
    </div>

    <div class="panel-body">
        
            <h3 id="introduction">Introduction</h3>
<p>Arguably (1-)category theory is the study of universal properties. There are three standard formulations of the notion of universal property which are all equivalent. Most introductions to category theory will cover all three and how they relate. By systematically preferring one formulation above the others, three styles of doing category theory arise with distinctive constructions and proof styles.</p>
<p>I noticed this trichotomy many years ago, but I haven’t heard anyone explicitly identify and compare these styles. Furthermore, in my opinion, one of these styles, the one I call <strong>Set</strong>-category theory, is significantly easier to use than the others, but seems poorly represented in introductions to category theory.</p>
<p>For myself, it wasn’t until I read <a href="http://www.tac.mta.ca/tac/reprints/articles/10/tr10abs.html">Basic Concepts of Enriched Category Theory</a> by G. M. Kelly and was introduced to indexed (co)limits (aka weighted (co)limits), that I began to recognize and appreciate <strong>Set</strong>-category theory. Indexed (co)limits are virtually absent from category theory introductions, and the closely related notion of (co)ends are also very weakly represented despite being far more useful than (conical) (co)limits. I don’t know why this is. Below I’ll be more focused on comparing the styles than illustrating the usefulness of indexed (co)limits. I may write an article about that in the future; in the mean time you can read “Basic Concepts of Enriched Category Theory” and just ignore the enriched aspect. Admittedly, it is definitely <em>not</em> an introduction to category theory.</p>

            <h6><a href="./posts/styles-of-category-theory.html">Read more...</a></h6>
        
    </div>

    <div class="panel-footer">
        <h6 class="blog-post-meta">
            September 30, 2015 05:45 UTC
            
            (Last updated on September 30, 2015 05:51 UTC)

            
                Tags: <a href="./tags/math.html">math</a>, <a href="./tags/category%20theory.html">category theory</a>
            
        </h6>
    </div>

</div><!-- /.blog-post -->



    <div class="blog-post teaser panel panel-default">
    <div class="panel-heading">
        <h2 class="blog-post-title"><a href="./posts/differentiation-under-the-integral.html">Differentiation under the integral</a></h2>
        <h6 class="pull-right" style="margin-top: -1.5ex"><a data-disqus-identifier="352A55FE-CF0D-4CEE-975F-E77624467A13" href="./posts/differentiation-under-the-integral.html#disqus_thread"></a></h6>
    </div>

    <div class="panel-body">
        
            <p><a href="raw/DiffUnderIntegral.pdf">Here</a> is a PDF with an informal proof of a very general form of <a href="https://en.wikipedia.org/wiki/Differentiation_under_the_integral_sign">differentiation under the integral</a>.</p>
<p>It’s formulated using geometric algebra and provides a simple demonstration of using some of the basic identities in geometric calculus.</p>
<p>The end result is:</p>
<p><img src="raw/diff-under-integral.svg" alt="d/(dt) int_(D(t)) L_t(x; d^m x) = int_(D(t)) dot L_t(x; (d^m x ^^ (del x)/(del t)) * dot grad_x) + int_(del D(t)) L_t(x; d^(m-1) x ^^ (del x)/(del t)) + int_(D(t))(del L_t(x; d^m x))/(del t)" /></p>
<!--
> `#d/(dt) int_(cc"D"(t)) bb"L"_t(bb"x"; d^m bb"x") 
>    = int_(cc"D"(t)) dot bb"L"_t(bb"x"; (d^m bb"x" ^^ (del x)/(del t)) * dot grad_(bb"x"))#
>  # + int_(del cc"D"(t)) bb"L"_t(bb"x"; d^(m-1) bb"x" ^^ (del x)/(del t))#
>  # + int_(cc"D"(t))(del bb"L"_t(bb"x"; d^m bb"x"))/(del t)#`{.asciimath}
-->
        
    </div>

    <div class="panel-footer">
        <h6 class="blog-post-meta">
            September 14, 2015 07:53 UTC
            
            (Last updated on May  7, 2016 18:25 UTC)

            
                Tags: <a href="./tags/math.html">math</a>, <a href="./tags/geometric%20algebra.html">geometric algebra</a>
            
        </h6>
    </div>

</div><!-- /.blog-post -->



    <div class="blog-post teaser panel panel-default">
    <div class="panel-heading">
        <h2 class="blog-post-title"><a href="./posts/convolution.html">A better way to write convolution</a></h2>
        <h6 class="pull-right" style="margin-top: -1.5ex"><a data-disqus-identifier="15CC5B1D-C7FE-46D9-B2DB-E7297B90A851" href="./posts/convolution.html#disqus_thread"></a></h6>
    </div>

    <div class="panel-body">
        
            <p>Normally discrete convolution is written as follows:</p>
<blockquote>
<p><code class="asciimath">#(f ** g)(n) = sum_(k=0)^n f(k)g(n-k)#</code></p>
</blockquote>
<p>It is not immediately obvious from this that #f ** g = g ** f#. Consider this alternate representation:</p>
<blockquote>
<p><code class="asciimath">#(f ** g)(n) = sum_(j+k=n) f(j)g(k)#</code></p>
</blockquote>
<p>This formula is obviously symmetric in #f# and #g# and it clarifies an important invariant. For example, to multiply two polynomials (or formal power series) we convolve their coefficients. This looks like:</p>
<p>Let <code class="asciimath">#P(x) = sum_k a_k x^k# and #Q(x) = sum_k b_k x^k#</code> then</p>
<blockquote>
<p><code class="asciimath">#P(x)Q(x) = sum_(j+k=n) a_j b_k x^n#</code></p>
</blockquote>
<p>This emphasizes that the #n#th coefficient is the product of the coefficients whose degrees sum to #n#. (You may recognize this as the convolution theorem.)</p>

            <h6><a href="./posts/convolution.html">Read more...</a></h6>
        
    </div>

    <div class="panel-footer">
        <h6 class="blog-post-meta">
            September 14, 2015 06:12 UTC
            
            (Last updated on September 14, 2015 07:55 UTC)

            
                Tags: <a href="./tags/math.html">math</a>
            
        </h6>
    </div>

</div><!-- /.blog-post -->



    <div class="blog-post teaser panel panel-default">
    <div class="panel-heading">
        <h2 class="blog-post-title"><a href="./posts/first-post.html">First post</a></h2>
        <h6 class="pull-right" style="margin-top: -1.5ex"><a data-disqus-identifier="F058BDA2-9158-4AC7-99A3-3D1D24F33F4B" href="./posts/first-post.html#disqus_thread"></a></h6>
    </div>

    <div class="panel-body">
        
            <p>I finally made a blog. We’ll see how it goes. Right now I’m in a kind of mathy mood so the coming posts will probably be pretty theoretical/mathematical. I do have a list of topics I’d like to write about, so I should be producing something for a while. If there’s something you’d like me to talk about, email me.</p>
        
    </div>

    <div class="panel-footer">
        <h6 class="blog-post-meta">
            September 14, 2015 06:12 UTC
            
            (Last updated on September 14, 2015 06:12 UTC)

            
                Tags: 
            
        </h6>
    </div>

</div><!-- /.blog-post -->




        </div><!-- /.blog-main -->
        
            <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
              
              <div class="sidebar-module panel panel-default" style="padding: 0;">
                <div class="panel-heading"><h4>Recent</h4></div>
                <div class="panel-body">
                    <ol class="list-unstyled">
                        
                          <li><div class="blog-post-link">2016-05-07 - <a href="./posts/constructivist-motto.html">Constructivist Motto</a></div></li>
                        
                          <li><div class="blog-post-link">2016-05-05 - <a href="./posts/the-mistake-everyone-makes-with-knockoutjs.html">The Mistake Everyone Makes with KnockoutJS</a></div></li>
                        
                          <li><div class="blog-post-link">2016-04-13 - <a href="./posts/understanding-typing-judgments.html">Understanding typing judgments</a></div></li>
                        
                          <li><div class="blog-post-link">2015-12-04 - <a href="./posts/high-dimensional-thought-experiment.html">High dimensional thought experiment from Hamming</a></div></li>
                        
                          <li><div class="blog-post-link">2015-11-17 - <a href="./posts/behavioral-reflection.html">Behavioral Reflection</a></div></li>
                        
                          <li><div class="blog-post-link">2015-11-02 - <a href="./posts/you-know-more-about-presheaves-than-you-think.html">You know more about presheaves than you think</a></div></li>
                        
                          <li><div class="blog-post-link">2015-09-30 - <a href="./posts/styles-of-category-theory.html">The three styles of category theory</a></div></li>
                        
                          <li><div class="blog-post-link">2015-09-14 - <a href="./posts/differentiation-under-the-integral.html">Differentiation under the integral</a></div></li>
                        
                          <li><div class="blog-post-link">2015-09-14 - <a href="./posts/convolution.html">A better way to write convolution</a></div></li>
                        
                          <li><div class="blog-post-link">2015-09-14 - <a href="./posts/first-post.html">First post</a></div></li>
                        
                    </ol>
                </div>
              </div>
              <div class="sidebar-module panel panel-default" style="padding: 0;">
                <div class="panel-heading"><h4>Tags</h4></div>
                <div class="panel-body">
                    <ol class="list-unstyled">
                      <li><a href="./tags/Agda.html">Agda (1)</a></li>
<li><a href="./tags/CS.html">CS (2)</a></li>
<li><a href="./tags/category%20theory.html">category theory (2)</a></li>
<li><a href="./tags/geometric%20algebra.html">geometric algebra (1)</a></li>
<li><a href="./tags/javascript.html">javascript (1)</a></li>
<li><a href="./tags/math.html">math (5)</a></li>
<li><a href="./tags/type%20theory.html">type theory (1)</a></li>
                    </ol>
                </div>
              </div>
            </div><!-- /.blog-sidebar -->
        
      </div><!-- /.row -->
    </div><!-- /.container -->

    <footer class="blog-footer">
      <p>Site generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a></p>
      <p>
        <a href="#">Back to top</a>
      </p>
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!--<script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>-->
    <script type="text/javascript">
        var disqus_shortname = 'hedonisticlearning';
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_HTMLorMML.js">
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          extensions: ['asciimath2jax.js'],
          asciimath2jax: {
              delimiters: [['|','|'], ['#','#']],
              processClass: 'asciimath'
            }
        });
    </script>
  </body>
</html>
